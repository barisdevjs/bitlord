<div class=" flex flex-col justify-start items-center mx-auto mt-16 gap-6">
    <mat-form-field class="w-full">
        <mat-label>Filter -- Case Sensitive</mat-label>
        <input matInput (keyup)="applyFilter($event)" placeholder="Ex. BTC" #input>
      </mat-form-field>
    <table mat-table [dataSource]="marketsArr" class="mat-elevation-z8 w-full">

        <ng-container matColumnDef="rowIndex" >
            <th mat-header-cell *matHeaderCellDef> No </th>
            <td mat-cell *matCellDef="let element;index as i;"> {{ i+1 }} </td>
        </ng-container>

        <ng-container matColumnDef="marketCode">
            <th mat-header-cell *matHeaderCellDef> Market Code </th>
            <td mat-cell *matCellDef="let element"> {{ element.marketCode }} </td>
        </ng-container>

        <ng-container matColumnDef="currentQuote">
            <th mat-header-cell *matHeaderCellDef> Current Quote </th>
            <td mat-cell *matCellDef="let element"> {{ element.currentQuote | number:'1.2-2' }} </td>
        </ng-container>

        <ng-container matColumnDef="change24h">
            <th mat-header-cell *matHeaderCellDef>Change (24h)</th>
            <td mat-cell *matCellDef="let element" [ngStyle]="getStyle(element.change24h)">
              {{ element.change24h }}
            </td>
          </ng-container>
          

        <ng-container matColumnDef="change24hPercent">
            <th mat-header-cell *matHeaderCellDef> Change (24h %) </th>
            <td mat-cell *matCellDef="let element"> {{ element.change24hPercent }} </td>
        </ng-container>

        <ng-container matColumnDef="highestQuote24h">
            <th mat-header-cell *matHeaderCellDef> Highest Quote (24h) </th>
            <td mat-cell *matCellDef="let element"> {{ element.highestQuote24h | number:'1.2-2'}} </td>
        </ng-container>

        <ng-container matColumnDef="lowestQuote24h">
            <th mat-header-cell *matHeaderCellDef> Lowest Quote (24h) </th>
            <td mat-cell *matCellDef="let element"> {{ element.lowestQuote24h | number:'1.2-2' }} </td>
        </ng-container>

        <tr mat-header-row class="bg-gray-200 text-lg font-medium " *matHeaderRowDef="displayedColumns; "></tr>
        <tr mat-row  *matRowDef="let row; columns: displayedColumns;"></tr>

        <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell" colspan="4">Aramanız <span class="bg-red-400">"{{input.value}}"</span> ile eşleşen sonuç
                bulunamadı. </td>
          </tr>

    </table>
    <mat-paginator [pageSizeOptions]="pageSizeOptions" ></mat-paginator>

    <ul *ngIf="marketsArr.filteredData && marketsArr.filteredData.length > 0" class="mt-6 space-y-2">
        <li *ngIf="countPositiveChanges() > 0" class="text-green-500">
          <span class="font-bold">{{ countPositiveChanges() }}</span> adet marketin fiyat değişim yüzdesi pozitif olmuştur.
        </li>
        <li *ngIf="maxIncreaseMarket" class="text-green-500">
          Bugün en fazla artış gösteren ( % {{ maxIncreaseMarket.change24hPercent }}) market <span class="font-bold">{{ maxIncreaseMarket.marketCode }}</span> marketi olmuştur.
        </li>
        <li *ngIf="maxDecreaseMarket" class="text-red-500">
          Bugün en fazla değer kaybeden ( % {{ maxDecreaseMarket.change24hPercent }}) market <span class="font-bold">{{ maxDecreaseMarket.marketCode }}</span> marketi olmuştur.
        </li>
        <li *ngIf="countMarketsAbovePriceThreshold(10000) > 0" class="text-green-500">
          Fiyatı 10,000 TRY üzerinde olan toplam <span class="font-bold">{{ countMarketsAbovePriceThreshold(10000) }}</span> adet market vardır.
        </li>
        <li *ngIf="countMarketsBelowPriceThreshold(1.00) > 0" class="text-red-500">
          Fiyatı 1.00 TRY'den daha az olan toplam <span class="font-bold">{{ countMarketsBelowPriceThreshold(1.00) }}</span> adet market vardır.
        </li>
        <li>
          Tüm marketlerdeki fiyatların toplamının (currentQuote) aritmetik ortalaması <span class="font-bold">{{ calculateAveragePrice() | number:'1.2-2' }}</span> TRY'dir.
        </li>
        <li *ngIf="usdExchangeRate">
          1 BTC = <span class="font-bold">{{ usdExchangeRate.toFixed(2) }}</span> ABD dolarıdır.
        </li>
      </ul>
      
    <div class="h-20"></div>

</div>